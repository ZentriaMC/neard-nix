From 425dfeeaa8557630125108b12c7bbfe01ea8325d Mon Sep 17 00:00:00 2001
From: Mark Vainomaa <mikroskeem@mikroskeem.eu>
Date: Tue, 9 May 2023 17:35:30 +0300
Subject: [PATCH] Make near-test-contracts optional

---
 Cargo.lock                                  | 22 ---------------------
 genesis-tools/genesis-populate/Cargo.toml   |  2 +-
 integration-tests/Cargo.toml                |  2 +-
 runtime/near-vm-runner/Cargo.toml           |  2 +-
 runtime/near-vm-runner/fuzz/Cargo.toml      |  2 +-
 runtime/runtime-params-estimator/Cargo.toml |  4 ++--
 runtime/runtime/Cargo.toml                  |  2 +-
 test-utils/runtime-tester/Cargo.toml        |  2 +-
 test-utils/testlib/Cargo.toml               |  2 +-
 tools/amend-genesis/Cargo.toml              |  2 +-
 tools/state-viewer/Cargo.toml               |  2 +-
 11 files changed, 11 insertions(+), 33 deletions(-)

diff --git a/Cargo.lock b/Cargo.lock
index 183705ac0..d3513ced9 100644
--- a/Cargo.lock
+++ b/Cargo.lock
@@ -2145,7 +2145,6 @@ dependencies = [
  "near-crypto",
  "near-primitives",
  "near-store",
- "near-test-contracts",
  "nearcore",
  "tempfile",
 ]
@@ -2541,7 +2540,6 @@ dependencies = [
  "near-stdx 0.16.0",
  "near-store",
  "near-telemetry",
- "near-test-contracts",
  "near-undo-block",
  "near-vm-errors",
  "near-vm-runner",
@@ -3079,7 +3077,6 @@ dependencies = [
  "near-primitives",
  "near-primitives-core",
  "near-store",
- "near-test-contracts",
  "nearcore",
  "node-runtime",
  "num-rational",
@@ -3922,18 +3919,6 @@ dependencies = [
  "tracing",
 ]
 
-[[package]]
-name = "near-test-contracts"
-version = "0.0.0"
-dependencies = [
- "arbitrary",
- "once_cell",
- "rand 0.8.5",
- "wasm-encoder 0.11.0",
- "wasm-smith",
- "wat",
-]
-
 [[package]]
 name = "near-undo-block"
 version = "0.0.0"
@@ -4117,7 +4102,6 @@ dependencies = [
  "near-primitives",
  "near-primitives-core",
  "near-stable-hasher",
- "near-test-contracts",
  "near-vm-compiler",
  "near-vm-compiler-singlepass",
  "near-vm-engine",
@@ -4156,7 +4140,6 @@ dependencies = [
  "arbitrary",
  "libfuzzer-sys",
  "near-primitives",
- "near-test-contracts",
  "near-vm-errors",
  "near-vm-logic",
  "near-vm-runner",
@@ -4353,7 +4336,6 @@ dependencies = [
  "near-o11y",
  "near-primitives",
  "near-store",
- "near-test-contracts",
  "near-vm-errors",
  "near-vm-logic",
  "near-vm-runner",
@@ -5502,7 +5484,6 @@ dependencies = [
  "near-o11y",
  "near-primitives",
  "near-store",
- "near-test-contracts",
  "near-vm-logic",
  "near-vm-runner",
  "nearcore",
@@ -5535,7 +5516,6 @@ dependencies = [
  "near-o11y",
  "near-primitives",
  "near-store",
- "near-test-contracts",
  "nearcore",
  "serde",
  "serde_json",
@@ -6138,7 +6118,6 @@ dependencies = [
  "near-primitives",
  "near-primitives-core",
  "near-store",
- "near-test-contracts",
  "nearcore",
  "node-runtime",
  "once_cell",
@@ -6332,7 +6311,6 @@ dependencies = [
  "near-chain-configs",
  "near-crypto",
  "near-primitives",
- "near-test-contracts",
  "node-runtime",
  "once_cell",
 ]
diff --git a/genesis-tools/genesis-populate/Cargo.toml b/genesis-tools/genesis-populate/Cargo.toml
index 57da41051..e4584742d 100644
--- a/genesis-tools/genesis-populate/Cargo.toml
+++ b/genesis-tools/genesis-populate/Cargo.toml
@@ -17,7 +17,7 @@ near-crypto.workspace = true
 near-primitives.workspace = true
 near-store.workspace = true
 near-chain.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 
 [features]
 nightly = [
diff --git a/integration-tests/Cargo.toml b/integration-tests/Cargo.toml
index 8039ef376..34e63163a 100644
--- a/integration-tests/Cargo.toml
+++ b/integration-tests/Cargo.toml
@@ -47,7 +47,7 @@ near-primitives-core.workspace = true
 near-store.workspace = true
 near-o11y.workspace = true
 near-telemetry.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 near-performance-metrics.workspace = true
 near-undo-block.workspace = true
 near-vm-errors.workspace = true
diff --git a/runtime/near-vm-runner/Cargo.toml b/runtime/near-vm-runner/Cargo.toml
index 6e97687ba..88d67683f 100644
--- a/runtime/near-vm-runner/Cargo.toml
+++ b/runtime/near-vm-runner/Cargo.toml
@@ -62,7 +62,7 @@ bolero.workspace = true
 expect-test.workspace = true
 hex.workspace = true
 near-primitives-core.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 rand.workspace = true
 wasm-smith.workspace = true
 wasmprinter.workspace = true
diff --git a/runtime/near-vm-runner/fuzz/Cargo.toml b/runtime/near-vm-runner/fuzz/Cargo.toml
index 95fdd9f2e..7fff79eae 100644
--- a/runtime/near-vm-runner/fuzz/Cargo.toml
+++ b/runtime/near-vm-runner/fuzz/Cargo.toml
@@ -15,7 +15,7 @@ wasm-smith.workspace = true
 wasmprinter.workspace = true
 
 near-primitives.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 near-vm-errors.workspace = true
 near-vm-logic.workspace = true
 near-vm-runner.workspace = true
diff --git a/runtime/runtime-params-estimator/Cargo.toml b/runtime/runtime-params-estimator/Cargo.toml
index 5a82b54a6..e6ff649d6 100644
--- a/runtime/runtime-params-estimator/Cargo.toml
+++ b/runtime/runtime-params-estimator/Cargo.toml
@@ -40,7 +40,7 @@ near-fmt.workspace = true
 near-o11y.workspace = true
 near-primitives.workspace = true
 near-store.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 near-vm-logic.workspace = true
 near-vm-runner.workspace = true
 nearcore.workspace = true
@@ -68,7 +68,7 @@ nightly = [
 ]
 nightly_protocol = [
   "near-primitives/nightly_protocol",
-  "near-test-contracts/nightly",
+  #"near-test-contracts/nightly",
 ]
 sandbox = ["node-runtime/sandbox"]
 io_trace = ["near-store/io_trace", "near-o11y/io_trace", "near-vm-logic/io_trace"]
diff --git a/runtime/runtime/Cargo.toml b/runtime/runtime/Cargo.toml
index 2faa6dde3..c837d05d8 100644
--- a/runtime/runtime/Cargo.toml
+++ b/runtime/runtime/Cargo.toml
@@ -53,5 +53,5 @@ tempfile.workspace = true
 
 near-chain-configs.workspace = true
 near-store = { workspace = true, features = ["test_features"] }
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 testlib.workspace = true
diff --git a/test-utils/runtime-tester/Cargo.toml b/test-utils/runtime-tester/Cargo.toml
index 3c2e9352f..315e12f60 100644
--- a/test-utils/runtime-tester/Cargo.toml
+++ b/test-utils/runtime-tester/Cargo.toml
@@ -23,7 +23,7 @@ nearcore.workspace = true
 near-primitives.workspace = true
 near-store.workspace = true
 near-o11y.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 
 [dev-dependencies]
 testlib.workspace = true
diff --git a/test-utils/testlib/Cargo.toml b/test-utils/testlib/Cargo.toml
index 9f2a4629f..15ae2f9ef 100644
--- a/test-utils/testlib/Cargo.toml
+++ b/test-utils/testlib/Cargo.toml
@@ -12,7 +12,7 @@ near-chain-configs.workspace = true
 near-chain.workspace = true
 near-crypto.workspace = true
 near-primitives.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 node-runtime.workspace = true
 
 [features]
diff --git a/tools/amend-genesis/Cargo.toml b/tools/amend-genesis/Cargo.toml
index 5b76dc9a1..32979cb10 100644
--- a/tools/amend-genesis/Cargo.toml
+++ b/tools/amend-genesis/Cargo.toml
@@ -23,6 +23,6 @@ near-network.workspace = true
 near-primitives.workspace = true
 near-primitives-core.workspace = true
 near-store.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 nearcore.workspace = true
 node-runtime.workspace = true
diff --git a/tools/state-viewer/Cargo.toml b/tools/state-viewer/Cargo.toml
index 4c414457b..a819f2e78 100644
--- a/tools/state-viewer/Cargo.toml
+++ b/tools/state-viewer/Cargo.toml
@@ -32,7 +32,7 @@ near-network.workspace = true
 near-primitives.workspace = true
 near-primitives-core.workspace = true
 near-store.workspace = true
-near-test-contracts.workspace = true
+#near-test-contracts.workspace = true
 nearcore.workspace = true
 node-runtime.workspace = true
 
-- 
2.40.0

